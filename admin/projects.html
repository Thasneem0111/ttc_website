<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>TTC - Admin Projects</title>
	<link rel="stylesheet" href="../styles.css">
	<style>
		/* admin layout copied from dashboard for consistency */
		.admin-shell{display:flex;min-height:100vh}
		.sidebar{width:260px;background:linear-gradient(180deg,#313131,#1a1a1a);color:#fff;padding:28px 18px;display:flex;flex-direction:column;justify-content:flex-start}
		.sidebar .sidebar-brand{display:flex;flex-direction:column;align-items:center;gap:4px;text-align:center}
		.logo-circle img{max-width:110px;max-height:110px;display:block}
		.brand-name{font-weight:800;font-size:14px;margin-top:6px;color:rgba(255,255,255,0.95)}
		.sidebar-nav{display:flex;flex-direction:column;margin-top:32px;gap:8px;align-items:stretch;width:100%}
		.sb-btn{background:transparent;border:none;color:inherit;padding:12px 14px;border-radius:8px;text-align:left;font-weight:700;cursor:pointer;transition:background .18s,transform .12s;width:100%}
		.sb-btn:hover{background:rgba(255, 255, 255, 0.06);transform:translateX(4px)}
		.sb-btn.active{background:rgba(255,255,255,0.12)}
		.sidebar-bottom{margin-top:auto}

		.admin-main{flex:1;padding:28px 34px;background-color:whitesmoke}
		.admin-header h1{margin:0 0 18px 0;font-size:28px;color:#000000}

		/* projects card */
		.card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 8px 30px rgba(4,20,20,0.04)}
		.panel-top{display:flex;gap:16px;align-items:center;margin-bottom:18px}
		.count{background:#595959;padding:10px 16px;border-radius:8px;font-weight:700}
		.search{flex:1;display:flex}
		.search input{flex:1;padding:12px 16px;border-radius:8px;border:1px solid #eef3f3;background:#fbfcfc}
		.projects-list{margin-top:12px;border-top:1px solid #f0f3f3}
		.project-item{display:flex;align-items:center;justify-content:space-between;padding:18px 8px;border-bottom:1px solid #f2f2f2}
		.project-left{display:flex;align-items:center;gap:14px}
		.project-title{font-weight:800;color:#083233}
		.project-meta{color:#6d7a78}
		.actions{display:flex;gap:12px;align-items:center}
		.trash-btn{background:transparent;border:none;cursor:pointer;color:#333;padding:6px;border-radius:6px;display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;transition:background .12s}
		.trash-btn svg{stroke:#6b6b6b}
		.trash-btn:hover{background:rgba(31,170,161,0.06)}
		.trash-btn:hover svg{stroke:var(--accent)}
		.btn{background:#1faaa1;color:#fff;padding:12px 22px;border-radius:28px;border:none;cursor:pointer}
		.btn.secondary{background:#2d9a95}
		.icon-btn{background:transparent;border:none;cursor:pointer;color:#222}

		@media (max-width:900px){.sidebar{display:none}.admin-shell{padding-left:12px;padding-right:12px}}
	</style>
</head>
<body>
	<div class="admin-shell">
		<aside class="sidebar">
			<div class="sidebar-top">
				<div class="sidebar-brand">
					<div class="logo-circle">
						<img src="../images/TTClogo.png" alt="TTC logo" onerror="this.style.display='none'">
					</div>
					<div class="brand-name">Turnkey Trading &amp; Contracting</div>
				</div>
			</div>

			<nav class="sidebar-nav">
				<button class="sb-btn" onclick="location.href='dashboard.html'">Dashboard</button>
				<button class="sb-btn" onclick="location.href='requests.html'">Requests</button>
				<button class="sb-btn active" onclick="location.href='projects.html'">Projects</button>
				<button class="sb-btn" onclick="location.href='services.html'">Services</button>
			</nav>

			<div class="sidebar-bottom">
				<button class="sb-btn">Settings</button>
				<button class="sb-btn logout">Logout</button>
			</div>
		</aside>

		<main class="admin-main">
			<header class="admin-header">
				<h1>Projects</h1>
			</header>

			<section class="card" id="projectsCard">
				<div class="panel-top">
					<div class="count">Total Projects <span id="totalCount" style="margin-left:8px">0</span></div>
					<div class="search">
						<input id="searchInput" placeholder="Search projects" />
						<button id="searchBtn" class="icon-btn" title="Search">üîç</button>
					</div>
				</div>

				<div class="projects-list" id="projectsList">
					<!-- projects rendered here -->
				</div>

				<div style="display:flex;justify-content:flex-end;margin-top:18px;gap:12px">
					<button id="updateBtn" class="btn secondary">Update Projects</button>
					<button id="addBtn" class="btn">Add new project</button>
				</div>
			</section>
		</main>
	</div>

	<script src="../script.js"></script>
	<script>
		// localStorage-based CRUD for projects
		const STORAGE_KEY = 'ttc_projects_v1'
		const defaultProjects = [
			{id:1,title:'Office Renovation',date:'12/01/2025'},
			{id:2,title:'Website Redesign',date:'11/15/2025'},
			{id:3,title:'Factory Maintenance',date:'10/30/2025'}
		]

		function loadProjects(){
			const raw = localStorage.getItem(STORAGE_KEY)
			if(!raw){ localStorage.setItem(STORAGE_KEY, JSON.stringify(defaultProjects)); return defaultProjects }
			try{ return JSON.parse(raw) }catch(e){ return defaultProjects }
		}
		function saveProjects(list){ localStorage.setItem(STORAGE_KEY, JSON.stringify(list)) }

		let projects = loadProjects()

		const projectsListEl = document.getElementById('projectsList')
		const totalCountEl = document.getElementById('totalCount')
		const searchInput = document.getElementById('searchInput')

		function render(filter){
			projectsListEl.innerHTML = ''
			const items = (filter? projects.filter(p=>p.title.toLowerCase().includes(filter.toLowerCase())) : projects)
			totalCountEl.textContent = items.length
			items.forEach(p=>{
				const row = document.createElement('div')
				row.className = 'project-item'
				row.innerHTML = `
					<div class="project-left">
						<input type="checkbox" data-id="${p.id}" />
						<div>
							<div class="project-title" data-id="${p.id}" style="cursor:pointer">${p.title}</div>
						</div>
					</div>
					<div class="actions">
						<div class="project-meta">${p.date}</div>
						<button class="trash-btn" title="Delete" data-id="${p.id}">
						  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
						    <path d="M3 6h18" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="#6b6b6b"/>
						    <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="#6b6b6b"/>
						    <path d="M10 11v6" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="#6b6b6b"/>
						    <path d="M14 11v6" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="#6b6b6b"/>
						    <path d="M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="#6b6b6b"/>
						  </svg>
						</button>
					</div>
				`
				projectsListEl.appendChild(row)
			})

			projectsListEl.querySelectorAll('.trash-btn[data-id]').forEach(btn=>{
				btn.onclick = ()=>{ const id = Number(btn.getAttribute('data-id')); deleteProject(id) }
			})
			projectsListEl.querySelectorAll('.project-title').forEach(t=>{
				t.onclick = ()=>{ const id = Number(t.getAttribute('data-id')); editProject(id) }
			})
		}

		function addProject(){
			const title = prompt('Project title')
			if(!title) return
			const id = Date.now()
			const date = new Date().toLocaleDateString()
			projects.unshift({id,title,date})
			saveProjects(projects)
			render(searchInput.value)
		}

		function deleteProject(id){
			if(!confirm('Delete this project?')) return
			projects = projects.filter(p=>p.id!==id)
			saveProjects(projects)
			render(searchInput.value)
		}

		function editProject(id){
			const pr = projects.find(p=>p.id===id)
			if(!pr) return
			const title = prompt('Update project title', pr.title)
			if(title===null) return
			pr.title = title
			pr.date = new Date().toLocaleDateString()
			saveProjects(projects)
			render(searchInput.value)
		}

		document.getElementById('addBtn').addEventListener('click', addProject)
		document.getElementById('updateBtn').addEventListener('click', ()=>{ saveProjects(projects); alert('Projects updated') })
		document.getElementById('searchBtn').addEventListener('click', ()=> render(searchInput.value))
		searchInput.addEventListener('input', e=> render(e.target.value))

		// initial render
		render()
	</script>
</body>
</html>
